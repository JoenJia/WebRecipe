pipeline {
    agent any

    stages {
    def theStage="all"
   stage('Get Code') {
   if (theStage in ["s1","all"]) {
      git 'https://github.com/JoenJia/WebRecipe/'}
   }
   stage('NuGet')
   {
    if (theStage in ["s2","all"]) {
      bat label: 'NuGet Restore', script: 'c:/tools/nuget.exe restore WebRecipe.sln'}
   }
   stage('NG Build') 
   {
    if (theStage in ["s3","all"]) {
       bat label: 'BG Build', script: 'cd RecipeService/ngapp && npm install && C:/Users/Joen/AppData/Roaming/npm/ng build' }
   }
   stage('.Net Build') 
   {
    if (theStage in ["s4","all"]) {
       bat "\"${tool 'MSBuild 2017'}\" WebRecipe.sln /p:Configuration=Release /p:Platform=\"Any CPU\" /p:ProductVersion=1.0.0.${env.BUILD_NUMBER}" }
   }
	stage('Archive')
    {
	 if (theStage in ["s5","all"]) {
		archiveArtifacts 'RecipeService/bin/**'}
    }
    }
}